<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <head>>

    </head>

    <body class="nav-md" >

        <ui:composition template="./templateG.xhtml">

            <ui:define name="content">
                <div class="row" ng-controller="myController"  ng-init="verifExist()">
                    <div class="col-md-12 col-sm-12 col-xs-12 col-lg-12">
                        <form  class="form-horizontal form-label-left" name="user" novalidate="true" ng-submit="submit()" action="informations.xhtml" method="POST" >
                            <div class="x_panel">
                                <div class="x_content" >
                                    <div class="x_title">
                                        <h3>Allocation Voyage D'affaire</h3>
                                        <div class="clearfix"></div>
                                    </div>
                                    <input value="#{menubarManagedBean.cl.clientPK.typePiecePersonne.toString()}" id="typePiecePersonne" hidden="true"/>
                                    <input value="#{menubarManagedBean.cl.telephone.toString()}" id="telPersonne" hidden="true"/>
                                    <input value="#{menubarManagedBean.cl.clientPK.noPiecePersonne.toString()}" id="noPiecePersonne" hidden="true"/>
                                    <div class="x_content" >
                                        <div class="x_title">
                                            <h2>Agence AVA</h2>
                                            <div class="clearfix"></div>
                                        </div>
                                        <div class="x_content">
                                            <br />
                                            <div class="col-md-12 col-sm-12 col-xs-12">
                                                <div class="form-group" >
                                                    <label class="control-label col-md-2 col-sm-4 col-xs-10">Agence</label>
                                                    <div class="col-md-6 col-sm-6 col-xs-10" ng-class="{ 'has-error' : user.agence.$invalid &amp;&amp; !user.agence.$pristine }">
                                                        <select class="select2_group form-control" name="agence" ng-model="ava.codeAgenceAva" required="true">
                                                            <optgroup label="Selectionner une agence">
                                                                <option></option>
                                                            <option ng-repeat ="x in agences.data track by $index" value="{{x.agencePK.codeAgenceBct}}">{{x.libAgence}}</option>
                                                            </optgroup>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="x_content" >
                                        <div class="x_title">
                                            <h2>Type Dossier</h2>
                                            <div class="clearfix"></div>
                                        </div>
                                        <div class="x_content">
                                            <br />
                                            <div class="col-md-12 col-sm-12 col-xs-12">
                                                <div class="form-group">
                                                    <label class="control-label col-md-2 col-sm-4 col-xs-10">Code</label>
                                                    <div class="col-md-6 col-sm-6 col-xs-10" ng-class="{ 'has-error' : user.code.$invalid &amp;&amp; !user.code.$pristine }">
                                                        <select class="select2_group form-control" name="code" ng-model="ava.codeTypeDosAva" required="true">
                                                            <optgroup label="Selectionner un dossier">  
                                                                <option></option>
                                                            <option ng-repeat ="x in tdossier.data track by $index" value="{{x.codeTypeDosAva}}">{{x.libTypeDosAva}}</option>
                                                            </optgroup>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="x_content">
                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                            <div class="x_title">
                                                <h2>Client</h2>
                                                <div class="clearfix"></div>
                                            </div>
                                            <div class="x_content">
                                                <br />
                                                <div class="col-md-12 col-sm-12 col-xs-12">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-2 col-sm-4 col-xs-10">Compte</label>
                                                        <div  class="col-md-6 col-sm-6 col-xs-10" ng-class="{ 'has-error' : user.cmp.$invalid &amp;&amp; !user.cmp.$pristine }" >
                                                            <select class="select2_group form-control" name="cmp" ng-model="compte" required="true"  ng-change="filter()">
                                                                    <optgroup label="Selectionner un compte">
                                                                        <option></option>
                                                                    <option ng-repeat ="x in CompteC.data track by $index" >{{x.comptePK.cleRib}}{{x.comptePK.codeAgenceBct}}{{x.comptePK.racineCompte}}</option>
                                                                    </optgroup>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="x_content">
                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                            <div class="x_title">
                                                <h2>Activite</h2>
                                                <div class="clearfix"></div>
                                            </div>
                                            <div class="x_content">
                                                <br />
                                                <div class="col-md-12 col-sm-12 col-xs-12">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-2 col-sm-4 col-xs-10">Activite</label>
                                                        <div class="col-md-6 col-sm-6 col-xs-10"  ng-class="{ 'has-error' : user.ac.$invalid &amp;&amp; !user.ac.$pristine }">
                                                            <select class="select2_group form-control" name="ac" ng-model="ava.codeActivite" required="true">
                                                                <optgroup label="Selectionner une acitive">
                                                                    <option></option>
                                                                <option ng-repeat ="x in activite.data track by $index" value="{{x.codeActivite}}" >{{x.libActivite}}</option>
                                                           </optgroup>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="x_content">
                                        <div class="x_title">
                                            <h2>Beneficiare</h2>
                                            <div class="clearfix"></div>
                                        </div>
                                        <div class="x_content">
                                            <br />
                                            <div class="col-md-12 col-sm-12 col-xs-12"  >
                                                <table datatable="ng" class="table table-striped table-bordered" cellspacing="0" width="100%" >
                                                    <thead>
                                                        <tr>
                                                            <th>type pieces</th>
                                                            <th>Numero</th>
                                                            <th>Date piece</th>
                                                            <th>Nom beneficiaire</th>
                                                            <th>Adresse beneficiaire</th>
                                                            <th>Qualite</th>
                                                            <th>Etat</th>
                                                            <th>Edit</th>
                                                            <th>Delete</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr ng-repeat="u in users track by $index">

                                                            <td>{{u.typePieceBenef}}</td>
                                                            <td >{{u.noPieceBenef}}</td>
                                                            <td>{{u.datePiece| date:'dd-MM-yyyy'}}</td>
                                                            <td>{{u.nomBenef}}</td>
                                                            <td>{{u.adresseBenef}}</td>
                                                            <td>{{u.qualite}}</td>
                                                            <td>{{u.etat}}</td>
                                                            <td><button type="button" class="btn btn-default" aria-label="justify" data-target="#buttonModal" data-toggle="modal" ng-click="edit($index)">
                                                                    <span  class="glyphicon glyphicon-edit" aria-hidden="true" >
                                                                    </span>
                                                                </button>
                                                            </td>
                                                            <td><button type="button" class="btn btn-default" aria-label="justify" ng-click="delete($index)">
                                                                    <span  class="glyphicon glyphicon-remove" aria-hidden="true">
                                                                    </span>
                                                                </button>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <a class="btn btn-primary btn-sm btnAdd" data-target="#buttonModal" data-toggle="modal" ng-click="reset()">ajouter beneficiaire</a>
                                                <div class="modal" id="buttonModal" data-keyboard="false" data-backdrop="false" role="dialog" data-show="true">
                                                    <div class="modal-dialog modal-sm">
                                                        <div class="modal-content"> 
                                                            <div class="modal-header">
                                                                <button class="close" data-dismiss="modal">&times;</button>
                                                                <h4 class="modal-title"> Remplir le formulaire</h4>
                                                            </div>
                                                            <div class="modal-body">
                                                                <div class="form-group"   ng-class="{ 'has-error' : user.type.$invalid &amp;&amp; !user.type.$pristine }">
                                                                    <label class="control-label col-md-3 col-sm-4 col-xs-10">Type piece</label>
                                                                    <div class="col-md-8 col-sm-8 col-xs-8">
                                                                        <select class="select2_group form-control" ng-model="newUser.typePieceBenef" name="type" required="true">
                                                                            <optgroup label="Selectionner le type de la piece">
                                                                                <option></option>
                                                                            <option ng-repeat ="x in tpiece.data" value="{{x.codeTypePiece}}">{{x.libelleTypePiece}}</option>
                                                                            </optgroup>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group" ng-class="{ 'has-error' : user.Numero.$invalid &amp;&amp; !user.Numero.$pristine }" >
                                                                    <label class="control-label col-md-3 col-sm-4 col-xs-10">Numero</label>
                                                                    <div class="col-md-8 col-sm-8 col-xs-8" >
                                                                        <input class="form-control col-md-4 col-xs-12" name="Numero" ng-model="newUser.noPieceBenef" required="true"/>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group" ng-class="{ 'has-error' : user.date.$invalid &amp;&amp; !user.date.$pristine }">
                                                                    <label class="control-label col-md-3 col-sm-4 col-xs-10">Date piece</label>
                                                                    <div class="col-md-8 col-sm-8 col-xs-8">
                                                                        <input type="date" id="date" class="form-control col-md-4 col-xs-12" ng-model="newUser.datePiece" name="date" required="true"/>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group" ng-class="{ 'has-error' : user.nom.$invalid &amp;&amp; !user.nom.$pristine }">
                                                                    <label class="control-label col-md-3 col-sm-4 col-xs-10">Nom Beneficiaire</label>
                                                                    <div class="col-md-8 col-sm-8 col-xs-8">
                                                                        <input id="val4" class="form-control col-md-4 col-xs-12" ng-model="newUser.nomBenef" name="nom" required="true"/>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group" ng-class="{ 'has-error' : user.adresse.$invalid &amp;&amp; !user.adresse.$pristine }">
                                                                    <label class="control-label col-md-3 col-sm-4 col-xs-10">Adresse Beneficiaire</label>
                                                                    <div class="col-md-8 col-sm-8 col-xs-8">
                                                                        <input id="val5" class="form-control col-md-4 col-xs-12" ng-model="newUser.adresseBenef" name="adresse" required="true"/>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group" ng-class="{ 'has-error' : user.qualite.$invalid &amp;&amp; !user.qualite.$pristine }">
                                                                    <label class="control-label col-md-3 col-sm-4 col-xs-10">Qualite</label>
                                                                    <div class="col-md-8 col-sm-8 col-xs-8">
                                                                        <input id="val6" class="form-control col-md-4 col-xs-12" ng-model="newUser.qualite" name="qualite" required="true"/>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group" ng-class="{ 'has-error' : user.etat.$invalid &amp;&amp; !user.etat.$pristine }">
                                                                    <label class="control-label col-md-3 col-sm-4 col-xs-10">Etat</label>
                                                                    <div class="col-md-8 col-sm-8 col-xs-8">
                                                                        <select class="select2_group form-control" ng-model="newUser.etat" name="etat" required="true">
                                                                            <optgroup label="Selectionner un etat">
                                                                                <option></option>
                                                                            <option value="A">Actif</option>
                                                                            <option value="AA">A acitver</option>
                                                                            <option value="NA">Non actif</option>
                                                                            <option value="AD">A desactiver</option>
                                                                            </optgroup>
                                                                        </select>
                                                                        <!--<input id="val7" class="form-control col-md-4 col-xs-12 required" ng-model="newUser.Etat" name="etat" required="true" />-->
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="modal-footer">
                                                                <button type="submit" class="btn btn-primary" aria-hidden="true"  ng-click="save()" ng-disabled="
                                                                    !(user.type.$valid &amp;&amp; !user.type.$pristine)
                                                                            || !(user.Numero.$valid &amp;&amp; !user.Numero.$pristine)
                                                                            || !(user.date.$valid &amp;&amp; !user.date.$pristine)
                                                                            || !(user.nom.$valid &amp;&amp; !user.nom.$pristine)
                                                                            || !(user.adresse.$valid &amp;&amp; !user.adresse.$pristine)
                                                                            || !(user.qualite.$valid &amp;&amp; !user.qualite.$pristine)
                                                                            || !(user.etat.$valid &amp;&amp; !user.etat.$pristine)
                                                                        " data-dismiss="modal">submit</button>
                                                                <button type="button" class="btn btn-primary" aria-hidden="true" ng-click="reset()" >reset</button>
                                                                <button class="btn btn-primary "  data-dismiss="modal" ng-click="reset()">Close</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div> 
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <button type="submit" id="submit" class="btn btn-primary" ng-disabled="
                                            ((!(user.agence.$valid &amp;&amp; !user.agence.$pristine))
                                                    || (!(user.code.$valid &amp;&amp; !user.code.$pristine))
                                                    || (!(user.cmp.$valid &amp;&amp; !user.cmp.$pristine))
                                                    || (!(user.ac.$valid &amp;&amp; !user.ac.$pristine)))
                                                ">submit</button>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <div>

                </div>

            </ui:define>

        </ui:composition>
    </body>
</html>
